import streamlit as st

st.set_page_config(page_title="🎯 کپشن‌ساز هوشمند", page_icon="🚀")
st.title("🎯 تولید کپشن، هشتگ و موسیقی بر اساس متن و کشور")

# موضوعات و لغات کلیدی
topic_keywords = {
    "آموزشی": ["آموزش", "یادگیری", "درس", "مهارت", "نکته"],
    "انگیزشی": ["هدف", "موفقیت", "پیشرفت", "دستاورد", "انگیزه"],
    "هنری": ["طراحی", "نقاشی", "رنگ", "خلاقیت", "اثر"],
    "پشت‌صحنه": ["پشت‌صحنه", "ساخت", "تمرین", "آماده‌سازی", "فرآیند"],
    "سبک زندگی": ["زندگی", "روتین", "آرامش", "لایف‌استایل", "سالم"],
    "طنز": ["شوخی", "طنز", "خنده", "لبخند", "با مزه"],
    "ماشین": ["ماشین", "خودرو", "رانندگی", "سرعت", "جاده", "اتومبیل"]
}

# دیتابیس کپشن‌ها و هشتگ‌ها
caption_db = {
    "آموزشی": {
        "captions": [
            "یادگیری یعنی قدرت.\nهر روز یه نکته، یه رشد.",
            "با آموزش، آینده‌تو بساز.\nدانش همیشه باهاته.",
            "هر مهارت، یه در جدیده.\nامروز چی یاد گرفتی؟",
            "نکته امروز رو از دست نده!\nیه جمله، یه تغییر."
        ],
        "hashtags": ["#آموزش", "#یادگیری", "#دانش", "#مهارت", "#رشد", "#education", "#learn", "#skills"]
    },
    "انگیزشی": {
        "captions": [
            "تو قوی‌تری از چیزی که فکر می‌کنی.\nهر قدم، یه پیروزیه.",
            "شکست؟ فقط یه قدم به جلو.\nادامه بده.",
            "امروزت رو بساز.\nفردا خودش میاد.",
            "دستاورد کوچیک، مسیر بزرگ.\nتو در راهی."
        ],
        "hashtags": ["#انگیزه", "#موفقیت", "#پیشرفت", "#هدف", "#مثبت_اندیشی", "#motivation", "#success", "#growth"]
    },
    "هنری": {
        "captions": [
            "با رنگ‌ها حرف می‌زنیم.\nهر اثر، یه تکه از روحه.",
            "خلق یعنی زنده بودن.\nزیبایی توی سادگیه.",
            "وقتی خلق می‌کنی، آروم می‌شی.\nاین یعنی هنر.",
            "هر خط، یه داستان.\nهر رنگ، یه حس."
        ],
        "hashtags": ["#هنر", "#خلاقیت", "#طراحی", "#نقاشی", "#زیبایی", "#art", "#design", "#creativity"]
    },
    "پشت‌صحنه": {
        "captions": [
            "پشت هر پست، یه داستانه.\nماجرا از اینجا شروع شد.",
            "جادو اینجاست.\nپشت‌پرده رو ببین.",
            "تمرین، تلاش، تکرار.\nاین یعنی مسیر واقعی.",
            "واقعیت همیشه جذابه.\nیه نگاه پشت‌صحنه بنداز."
        ],
        "hashtags": ["#پشت_صحنه", "#واقعی", "#تیم", "#فرآیند", "#داستان", "#behindthescenes", "#workflow", "#team"]
    },
    "سبک زندگی": {
        "captions": [
            "زندگی یعنی لذت از لحظه‌ها.\nتفاوت توی جزئیاته.",
            "سبک زندگی = امضای شخصیت.\nبا آرامش زندگی کن.",
            "زندگی سالم، ذهن آروم.\nروتینت رو بساز.",
            "هر انتخاب، یه سبک.\nتو انتخاب می‌کنی."
        ],
        "hashtags": ["#سبک_زندگی", "#لایف_استایل", "#زندگی_سالم", "#آرامش", "#انتخاب", "#lifestyle", "#wellness", "#routine"]
    },
    "طنز": {
        "captions": [
            "اگه نخندیدی، دوباره بخونش!\nطنز یعنی زاویه خنده‌دار.",
            "زندگی بدون شوخی؟\nجدی نیست!",
            "شوخی کوچیک، حال خوب بزرگ.\nبخند، زندگی کوتاهه.",
            "طنز یعنی بازی با واقعیت.\nهمه‌چی آسون‌تر می‌شه."
        ],
        "hashtags": ["#طنز", "#شوخی", "#لبخند", "#حال_خوب", "#خنده", "#funny", "#humor", "#smile"]
    },
    "ماشین": {
        "captions": [
            "ماشینت حرف می‌زنه؟\nگوش بده، جاده منتظره.",
            "سرعت خوبه،\nوقتی کنترل دست توئه.",
            "ماشین فقط وسیله نیست.\nیه حس آزادیه.",
            "هر رانندگی، یه سفره.\nهر سفر، یه داستان."
        ],
        "hashtags": ["#ماشین", "#خودرو", "#جاده", "#رانندگی", "#اتومبیل", "#car", "#drive", "#roadtrip"]
    }
}

music_style = {
    "آموزشی": "lofi instrumental",
    "انگیزشی": "motivational pop",
    "هنری": "ambient classical",
    "پشت‌صحنه": "behind the scenes chill",
    "سبک زندگی": "chill lifestyle",
    "طنز": "fun upbeat",
    "ماشین": "driving beats"
}

# ورودی‌ها
country = st.selectbox("🌍 کشور مورد نظر:", ["ایران", "ترکیه", "آلمان", "امارات", "آمریکا"])
user_input = st.text_input("✍️ چند کلمه درباره پستت بنویس:")
search_input = st.text_input("🔍 جست‌وجوی موضوع (مثلاً 'ماشین' یا 'آموزش'):")

# تشخیص موضوع
def detect_topic(text):
    for topic, keywords in topic_keywords.items():
        for word in keywords:
            if word in text:
                return topic
    return None

filtered_topics = [topic for topic in caption_db if search_input.lower() in topic.lower()]
selected_topic = st.selectbox("📌 انتخاب موضوع:", filtered_topics if filtered_topics else list(caption_db.keys()))
final_topic = detect_topic(user_input) if user_input else selected_topic

# نمایش خروجی‌ها
if final_topic:
    st.success(f"موضوع انتخاب‌شده: {final_topic}")

    if st.button("✍️ نمایش کپشن‌ها"):
        st.markdown("### ✍️ کپشن‌های پیشنهادی:")
        for i, caption in enumerate(caption_db[final_topic]["captions"], 1):
            st.markdown(f"*{i}.* {caption}")

    if st.button("🏷️ نمایش هشتگ‌ها"):
        st.markdown("### 🏷️ هشتگ‌های مناسب:")
        st.write(" ".join(caption_db[final_topic]["hashtags"]))

    if st.button("🎵 نمایش لینک موسیقی"):
        query = f"{music_style[final_topic]} music {country} دانلود مستقیم"
        search_link = f"https://www.google.com/search?q={query.replace(' ', '+')}"
        st.markdown("### 🎵 آهنگ پیشنهادی:")
        st.write(f"[جست‌وجوی آهنگ مناسب در گوگل]({search_link})")
